# 05 脚本
## 脚本基础
1. 在使用计算的时候，经常有大段重复性或相似性的命令输入。为了减轻使用者负担，可以将这些命令段落用文本记录下来，然后让bash读取文本中的命令逐条执行。
2. 这个记录命令序列的文本就叫做脚本。脚本本是剧本的意思。bash编程工作就像是给bash写剧本让它按着去演，所以这里用了脚本一词。
3. 编写脚本十分简单，就是把命令按顺序写在文本中。一行一条命令。
4. 如果希望把多条命令写在同一行。各条命令之间用分号隔开。
5. 脚本本身是个文本文件，但是在bash中也是可执行文件。有时用文本编辑器创建的新脚本没有执行权限，需要修改一下文件权限。
## 启动文件
1. shell在启动的时候会自动执行一些脚本，初始化环境变量和一些shell脚本函数。这些脚本称为启动文件。
2. 启动文件主要有对所有用户都起效的/etc/profile和用户定制的启动文件两类。
3. shell有三种启动模式，根据启动模式不同，会使用不同的启动文件。这三类启动模式是：
    * 用户登录后启动的shell。
    * 非登录启动的交互式shell。例如在其他shell进程中用命令bash启动的bash shell。
    * 用于执行脚本的非交互式shell。每当运行一个脚本，就会自动启动一个bash执行它。由于我们不能通过键盘给这个进程输入命令，所以称为非交互式。
4. 登录启动的shell首先会执行/etc/profile。如果需要初始化的东西很多还会有一个/etc/profile.d文件夹。profile会调用这个文件夹中的脚本。
5. 其他两种shell启动方式不执行/etc/profile。但是由于它们是登录shell的子进程，会继承登录shell的一些变量。
6. 登录启动的shell执行完/etc/profile后会执行$HOME下用户专属的启动文件。按执行顺序有以下几个：
    * $HOME/.bash_profile
    * $HOME/.bash_login
    * $HOME/.profile
    还要注意以下几点
    * 另有一个$HOME/.bashrc被其他脚本调用而执行。
    * 这些文件不一定都要有。一般只会用到一两个。
7. 交互式shell在启动时还会执行一次`$HOME/.bashrc`。
8. 非交互shell在启动时默认不执行启动文件。如果需要启动文件，可以在环境变量BASH_ENV中指定。
## 修改持久化
1. 如果你希望保存对环境变量的修改，或者希望在启动shell后自动执行一些命令。就可以修改shell的启动文件。
2. 但是一般不把大量的修改直接放到系统默认的启动文件中。而是先写一个自己的启动脚本，然后在标准的启动文件中调用自己的脚本。
3. 另外，尽量不扩大修改的影响范围。如果不是必须让所有用户都用的修改，就尽量不修改在/etc/profile中。尽量把自定义局限在用户内，而不扩散到全局。这样即使出现问题，也不会影响其他用户账号。
